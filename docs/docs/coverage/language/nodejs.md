# Node.js

Vul supports three types of Node.js package managers: `npm`, `Yarn` and `pnpm`.

The following scanners are supported.

| Artifact | SBOM  | Vulnerability | License |
| -------- | :---: | :-----------: | :-----: |
| npm      |   ✓   |       ✓       |    ✓    |
| Yarn     |   ✓   |       ✓       |    -    |
| pnpm     |   ✓   |       ✓       |    -    |

The following table provides an outline of the features Vul offers.

| Package manager | File              | Transitive dependencies | Dev dependencies  | [Dependency graph][dependency-graph] | Position |
|:---------------:|-------------------|:-----------------------:|:-----------------:|:------------------------------------:|:--------:|
|       npm       | package-lock.json |            ✓            | [Excluded](#npm)  |                  ✓                   |    ✓     |
|      Yarn       | yarn.lock         |            ✓            | [Excluded](#yarn) |                  ✓                   |    ✓     |
|      pnpm       | pnpm-lock.yaml    |            ✓            |     Excluded      |                  ✓                   |    -     |

In addition, Vul scans installed packages with `package.json`.

| File         | Dependency graph | Position | License |
| ------------ | :--------------: | :------: | :-----: |
| package.json |        -         |    -     |    ✅    |

These may be enabled or disabled depending on the target.
See [here](./index.md) for the detail.

## Package managers
Vul parses your files generated by package managers in filesystem/repository scanning.

!!! tip
    Please make sure your lock file is up-to-date after modifying `package.json`.

### npm
Vul parses `package-lock.json`.
To identify licenses, you need to download dependencies to `node_modules` beforehand.
Vul analyzes `node_modules` for licenses.

By default, Vul doesn't report development dependencies. Use the `--include-dev-deps` flag to include them.

### Yarn
Vul parses `yarn.lock`, which doesn't contain information about development dependencies.
To exclude devDependencies, `package.json` also needs to be present next to `yarn.lock`. 
Vul analyzes `.yarn` (Yarn 2+) or `node_modules` (Yarn Classic) folder next to the yarn.lock file to detect licenses.

By default, Vul doesn't report development dependencies. Use the `--include-dev-deps` flag to include them.

### pnpm
Vul parses `pnpm-lock.yaml`, then finds production dependencies and builds a [tree][dependency-graph] of dependencies with vulnerabilities.

## Packages
Vul parses the manifest files of installed packages in container image scanning and so on.

### package.json
Vul searches for `package.json` files under `node_modules` and identifies installed packages.
It only extracts package names, versions and licenses for those packages.

[dependency-graph]: ../../configuration/reporting.md#show-origins-of-vulnerable-dependencies